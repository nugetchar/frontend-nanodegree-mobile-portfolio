<!DOCTYPE html>

<html>
<head>
  <title>index.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../../../../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>index.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">rows_, opts</span>) </span>{
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    <span class="hljs-keyword">var</span> hsep = opts.hsep === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">'  '</span> : opts.hsep;
    <span class="hljs-keyword">var</span> align = opts.align || [];
    <span class="hljs-keyword">var</span> stringLength = opts.stringLength
        || <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">s</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(s).length; }
    ;
    
    <span class="hljs-keyword">var</span> dotsizes = reduce(rows_, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">acc, row</span>) </span>{
        forEach(row, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">c, ix</span>) </span>{
            <span class="hljs-keyword">var</span> n = dotindex(c);
            <span class="hljs-keyword">if</span> (!acc[ix] || n &gt; acc[ix]) acc[ix] = n;
        });
        <span class="hljs-keyword">return</span> acc;
    }, []);
    
    <span class="hljs-keyword">var</span> rows = map(rows_, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row</span>) </span>{
        <span class="hljs-keyword">return</span> map(row, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">c_, ix</span>) </span>{
            <span class="hljs-keyword">var</span> c = <span class="hljs-built_in">String</span>(c_);
            <span class="hljs-keyword">if</span> (align[ix] === <span class="hljs-string">'.'</span>) {
                <span class="hljs-keyword">var</span> index = dotindex(c);
                <span class="hljs-keyword">var</span> size = dotsizes[ix] + (<span class="hljs-regexp">/\./</span>.test(c) ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span>)
                    - (stringLength(c) - index)
                ;
                <span class="hljs-keyword">return</span> c + <span class="hljs-built_in">Array</span>(size).join(<span class="hljs-string">' '</span>);
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> c;
        });
    });
    
    <span class="hljs-keyword">var</span> sizes = reduce(rows, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">acc, row</span>) </span>{
        forEach(row, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">c, ix</span>) </span>{
            <span class="hljs-keyword">var</span> n = stringLength(c);
            <span class="hljs-keyword">if</span> (!acc[ix] || n &gt; acc[ix]) acc[ix] = n;
        });
        <span class="hljs-keyword">return</span> acc;
    }, []);
    
    <span class="hljs-keyword">return</span> map(rows, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row</span>) </span>{
        <span class="hljs-keyword">return</span> map(row, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">c, ix</span>) </span>{
            <span class="hljs-keyword">var</span> n = (sizes[ix] - stringLength(c)) || <span class="hljs-number">0</span>;
            <span class="hljs-keyword">var</span> s = <span class="hljs-built_in">Array</span>(<span class="hljs-built_in">Math</span>.max(n + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)).join(<span class="hljs-string">' '</span>);
            <span class="hljs-keyword">if</span> (align[ix] === <span class="hljs-string">'r'</span> || align[ix] === <span class="hljs-string">'.'</span>) {
                <span class="hljs-keyword">return</span> s + c;
            }
            <span class="hljs-keyword">if</span> (align[ix] === <span class="hljs-string">'c'</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>(<span class="hljs-built_in">Math</span>.ceil(n / <span class="hljs-number">2</span> + <span class="hljs-number">1</span>)).join(<span class="hljs-string">' '</span>)
                    + c + <span class="hljs-built_in">Array</span>(<span class="hljs-built_in">Math</span>.floor(n / <span class="hljs-number">2</span> + <span class="hljs-number">1</span>)).join(<span class="hljs-string">' '</span>)
                ;
            }
            
            <span class="hljs-keyword">return</span> c + s;
        }).join(hsep).replace(<span class="hljs-regexp">/\s+$/</span>, <span class="hljs-string">''</span>);
    }).join(<span class="hljs-string">'\n'</span>);
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dotindex</span> (<span class="hljs-params">c</span>) </span>{
    <span class="hljs-keyword">var</span> m = <span class="hljs-regexp">/\.[^.]*$/</span>.exec(c);
    <span class="hljs-keyword">return</span> m ? m.index + <span class="hljs-number">1</span> : c.length;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reduce</span> (<span class="hljs-params">xs, f, init</span>) </span>{
    <span class="hljs-keyword">if</span> (xs.reduce) <span class="hljs-keyword">return</span> xs.reduce(f, init);
    <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> acc = <span class="hljs-built_in">arguments</span>.length &gt;= <span class="hljs-number">3</span> ? init : xs[i++];
    <span class="hljs-keyword">for</span> (; i &lt; xs.length; i++) {
        f(acc, xs[i], i);
    }
    <span class="hljs-keyword">return</span> acc;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forEach</span> (<span class="hljs-params">xs, f</span>) </span>{
    <span class="hljs-keyword">if</span> (xs.forEach) <span class="hljs-keyword">return</span> xs.forEach(f);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; xs.length; i++) {
        f.call(xs, xs[i], i);
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">map</span> (<span class="hljs-params">xs, f</span>) </span>{
    <span class="hljs-keyword">if</span> (xs.map) <span class="hljs-keyword">return</span> xs.map(f);
    <span class="hljs-keyword">var</span> res = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; xs.length; i++) {
        res.push(f.call(xs, xs[i], i));
    }
    <span class="hljs-keyword">return</span> res;
}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
