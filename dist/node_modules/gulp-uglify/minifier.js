"use strict";function trycatch(e,r){try{return e()}catch(t){return r(t)}}function setup(e){e&&!isObject(e)&&(log("gulp-uglify expects an object, non-object provided"),e={});var r=deap({},e,{fromString:!0,output:{}});return"all"===r.preserveComments?r.output.comments=!0:"some"===r.preserveComments?r.output.comments=/^!|@preserve|@license|@cc_on/i:"license"===r.preserveComments?r.output.comments=saveLicense:"function"==typeof r.preserveComments&&(r.output.comments=r.preserveComments),r}function createError(e,r){if("string"==typeof r)return new PluginError(pluginName,e.path+": "+r,{fileName:e.path,showStack:!1});var t=r.message||r.msg||"unspecified error";return new PluginError(pluginName,e.path+": "+t,{fileName:e.path,lineNumber:r.line,stack:r.stack,showStack:!1})}var through=require("through2"),deap=require("deap"),PluginError=require("gulp-util/lib/PluginError"),log=require("fancy-log"),applySourceMap=require("vinyl-sourcemaps-apply"),saveLicense=require("uglify-save-license"),isObject=require("isobject"),reSourceMapComment=/\n\/\/# sourceMappingURL=.+?$/,pluginName="gulp-uglify";module.exports=function(e,r){function t(t,n,u){var o=setup(e||{});if(t.isNull())return u(null,t);if(t.isStream())return u(createError(t,"Streaming not supported"));t.sourceMap&&(o.outSourceMap=t.relative);var i=trycatch(function(){var e=r.minify(String(t.contents),o);return e.code=new Buffer(e.code.replace(reSourceMapComment,"")),e},createError.bind(null,t));if(i instanceof PluginError)return u(i);if(t.contents=i.code,t.sourceMap){var c=JSON.parse(i.map);c.sources=[t.relative],applySourceMap(t,c)}u(null,t)}return through.obj(t)};